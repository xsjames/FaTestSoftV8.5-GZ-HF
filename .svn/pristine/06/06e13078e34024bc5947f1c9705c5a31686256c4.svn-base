using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using KD.WinFormsUI.Docking;
using FaTestSoft.CommonData;
using FaTestSoft.FUNCTIONCLASS;

namespace FaTestSoft
{
    public partial class CallDataDocmentView : DockContent
    {
        public CallDataDocmentView()
        {
            InitializeComponent();
        }
        private DataSet PaginationSet = new DataSet();  //定义存储数据的集合
        private DataTable PageTable = new DataTable();//定义一个数据表
        private DataTable LiShiTable = new DataTable();//定义一个数据表
        private DataTable SaveTable = new DataTable();
        private DataTable YcDataTable = new DataTable();
        private Page Pagefm = new Page();     //定义一个具有分页功能的类

        string[] datastr = new string[5];
        static int pagenum = 0;
        static int pagenumLine = 0;
        static int pagenumIndex = 0;
        static int pagenow = 1;                 //当前页号
        static int pagetotal = 0;                 //总页号
        static int datepos = 0;
        public int num = 0;
        public int index = 0;
        private int ty;
        string str = @"";
        bool First_Start;
        bool First_Frame = true;    //第一帧
        bool saveret = false;
        string savename;
        int delaytime;//循环召测间隔
        int ShowType = 1;//选择类型  0：按线路   1：按序号
     



        DataRow dr;
        /// <summary>
        /// 窗体的初始化
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void CallDataDocmentView_Load(object sender, EventArgs e)
        {
            timer2.Enabled = false;
            comboBoxData.SelectedIndex = 0;
            domainUpDownb.Enabled = true;
            checkBox1.Checked = false;
            comboBoxselete.Enabled = true;
            comboBoxselete.SelectedIndex = 1;





            if (PublicDataClass.SaveText.devicenum == 0)
            {
                comboBoxPoint.Text = "无信息";

            }
            else
            {
                for (byte i = 0; i < PublicDataClass.SaveText.devicenum; i++)
                {
                    comboBoxPoint.Items.Add(PublicDataClass.SaveText.Device[i].PointName);
                }
                comboBoxPoint.Text = PublicDataClass.SaveText.Device[0].PointName;

            }
            num = PublicDataClass.SaveText.devicenum;


            DataSet PageSet = new DataSet();// 定义一个存储数据的集合

            PageSet.Clear();//清空数据集中原有内容
            //FillDataTable(selectString, ref PageSet);//型数据表中填充数据


            Pagefm.ItemsPerPage = 8;//设定每页显示多少行


            PageTable.Columns.Add("序号", System.Type.GetType("System.String"));
            PageTable.Columns.Add("名称", System.Type.GetType("System.String"));
            PageTable.Columns.Add("数值", System.Type.GetType("System.String"));
            PageTable.Columns.Add("单位", System.Type.GetType("System.String"));
            PageTable.Columns.Add("倍率", System.Type.GetType("System.String"));

            LiShiTable.Columns.Add("序号", System.Type.GetType("System.String"));
            LiShiTable.Columns.Add("名称", System.Type.GetType("System.String"));
            LiShiTable.Columns.Add("数值", System.Type.GetType("System.String"));
            LiShiTable.Columns.Add("单位", System.Type.GetType("System.String"));
            LiShiTable.Columns.Add("倍率", System.Type.GetType("System.String"));
            //③Add rows for DataTable
            //★Initialize the row
            /*DataRow dr = PageTable.NewRow();
            dr["序号"] = "A";
            dr["名称"] = "B";
            dr["数值"] = "C";
            dr["单位"] = "D";
            dr["倍率"] = "E";
            PageTable.Rows.Add(dr);*/


            //★Doesn't initialize the row
            /*DataRow dr1 = dt.NewRow();
            dt.Rows.Add(dr1);*/

            //if(PageSet.Tables.Count !=0)
            //Pagefm.SetDataSet(PageSet, out PageTable);//设置当前数据集中的内容
            //Display(PageTable);//显示数据

            ListData.Columns[1].Width = (splitContainer2.Panel1.Width - ListData.Columns[0].Width - ListData.Columns[3].Width - ListData.Columns[4].Width) / 2;
            ListData.Columns[2].Width = (splitContainer2.Panel1.Width - ListData.Columns[0].Width - ListData.Columns[3].Width - ListData.Columns[4].Width) / 2;
            //splitContainer2.Panel1.Width

            FistPage.Enabled = false;
            LastPage.Enabled = false;
            NextPage.Enabled = false;
            PreviousPage.Enabled = false;
            First_Start = true;

            for (int ch = 5; ch < 100; ch++)
            {
                domainUpDownb.Items.Add(ch);

            }
            domainUpDownb.SelectedIndex = 0;
        }
        private byte FindCfgInfo()
        {
            byte i = 0;
            for (i = 0; i < PublicDataClass.SaveText.cfgnum; i++)
            {
                if (comboBoxPoint.Text == PublicDataClass.SaveText.Device[i].PointName)
                {
                    break;
                }
            }
            return i;
        }
        /// <summary>
        /// 召测按钮---事件的处理过程
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void buttonCall_Click(object sender, EventArgs e)
        {
            if (PublicDataClass.LinSPointName == "无信息")
            {
                MessageBox.Show("无测量点信息可操作", "信息", MessageBoxButtons.OK, MessageBoxIcon.Error);
                return;
            }
            else
            {
                ty = PublicFunction.CheckPointOfCommunicationEntrace(comboBoxPoint.Text);
                if (ty == 0)
                {
                    MessageBox.Show("无测量点信息可操作", "信息", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    return;

                }

            }
            if (comboBoxData.SelectedIndex == 0)    //F0_遥测
            {
                datepos = 0;
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.AloneCallYc_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.AloneCallYc_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.AloneCallYc_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.AloneCallYc_1 = true;

            }
            else if (comboBoxData.SelectedIndex == 1)  //F1__遥信
            {
                datepos = 0;
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.AloneCallYx_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.AloneCallYx_1 = true;

                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.AloneCallYx_1 = true;

                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.AloneCallYx_1 = true;
            }
            else if (comboBoxData.SelectedIndex == 2)  //F3__遥脉
            {
                //listView1.Items.Clear();
            }
            else if (comboBoxData.SelectedIndex == 3)          //版本号
            {
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.VERSION_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.VERSION_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.VERSION_1 = true;

                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.VERSION_1 = true;

            }
            else if (comboBoxData.SelectedIndex == 4)        //时间
            {
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.CALLTIME_1 = true;

                else if (ty == 2)
                    PublicDataClass._NetTaskFlag.CALLTIME_1 = true;
                else if (ty == 3)
                    PublicDataClass._GprsTaskFlag.CALLTIME_1 = true;
                else if (ty == 4)
                    PublicDataClass._UsbTaskFlag.CALLTIME_1 = true;

            }
            else if (comboBoxData.SelectedIndex == 5)          //F6__1类数据
            {
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.VERSION_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.VERSION_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.VERSION_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.VERSION_1 = true;

            }
            else if (comboBoxData.SelectedIndex == 6)        //F7__2类数据
            {
                //listView1.Items.Clear();

            }
            else if (comboBoxData.SelectedIndex == 7)        //F8__网络参数
            {
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x5001;

            }
            else if (comboBoxData.SelectedIndex == 8)        //F9__系统参数
            {
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x5100;

            }
            else if (comboBoxData.SelectedIndex == 9)        //F10__遥测参数
            {
                datepos = 0;
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x7001;

            }
            else if (comboBoxData.SelectedIndex == 10)        //F11__遥信参数
            {
                //listView1.Items.Clear();
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x8001;

            }
            else if (comboBoxData.SelectedIndex == 11)        //F12__遥控参数
            {
                //listView1.Items.Clear();
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x9001;

            }
            else if (comboBoxData.SelectedIndex == 12)        //F13__遥信配置参数
            {
                //listView1.Items.Clear();
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0xa001;

            }
            else if (comboBoxData.SelectedIndex == 13)        //F14__遥测配置参数
            {
                datepos = 0;
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0xb001;
            }
            else if (comboBoxData.SelectedIndex == 14)      //F15__串口参数
            {
                datepos = 0;
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x5200;

            }
            else if (comboBoxData.SelectedIndex == 15)        //内遥信
            {
                //listView1.Items.Clear();
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.AloneCallYx_2 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.AloneCallYx_2 = true;

                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.AloneCallYx_2 = true;

                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.AloneCallYx_2 = true;
            }
            else if (comboBoxData.SelectedIndex == 16)        //越限参数
            {
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x5300;

            }
            else if (comboBoxData.SelectedIndex == 17)        //索引记录
            {
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x5400;

            }
            else if (comboBoxData.SelectedIndex == 18)        //信息表参数读取   zxl
            {
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0xF001;

            }

            else if (comboBoxData.SelectedIndex == 19)        //硬件状态读取   zxl
            {
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_Hard_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_Hard_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_Hard_1= true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_Hard_1 = true;
               

            }
            else if (comboBoxData.SelectedIndex == 20)        //软压板参数读取   zxl
            {
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0xF101;


            }
            else if (comboBoxData.SelectedIndex == 21)        //遥控逻辑配置参数读取   zxl
            {
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0xF201;


            }
            else if (comboBoxData.SelectedIndex == 22)        //遥信取反
            {
                //listView1.Items.Clear();
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0xf301;   //地址待定

            }
            else if (comboBoxData.SelectedIndex == 23)        //反时限保护参数
            {
                datepos = 0;
                if (ty == 1)
                    PublicDataClass._ComTaskFlag.READ_P_1 = true;

                if (ty == 2)
                    PublicDataClass._NetTaskFlag.READ_P_1 = true;
                if (ty == 3)
                    PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                if (ty == 4)
                    PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                PublicDataClass.ParamInfoAddr = 0x5900;
            }
        }
        /// <summary>
        /// 定时器的事件处理函数
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        /// <param anthor="cuibj"></param>
        /// <param Time="11-04-28"></param>
        private void timer1_Tick(object sender, EventArgs e)
        {
            if (PublicDataClass._WindowsVisable.CallDataUpdatVisable == true)  //窗体可见
            {

                if (PublicDataClass._Message.CallDataDocmentView == true)
                {
                    PublicDataClass._Message.CallDataDocmentView = false;


                    ProcessShowAllInfo();
                }
            }
            if (saveret)
            {
                saveret = false;
                ExportToExcel(savename);
                output.Text = "导出";
                MessageBox.Show("数据导出成功", "信息", MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
        }
        /// <summary>
        /// 窗体激活---事件
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void CallDataDocmentView_Activated(object sender, EventArgs e)
        {
            PublicDataClass._WindowsVisable.CallDataUpdatVisable = true;            //窗体可见
            timer1.Enabled = true;
            if (num == PublicDataClass.SaveText.devicenum)
                return;
            comboBoxPoint.Items.Clear();
            num = PublicDataClass.SaveText.devicenum;
            if (PublicDataClass.SaveText.devicenum == 0)
            {
                comboBoxPoint.Text = "无信息";

            }
            else
            {
                for (byte i = 0; i < PublicDataClass.SaveText.devicenum; i++)
                {
                    comboBoxPoint.Items.Add(PublicDataClass.SaveText.Device[i].PointName);//添加测量点名称信息
                }
                comboBoxPoint.Text = PublicDataClass.SaveText.Device[0].PointName;

            }

        }
        /// <summary>
        /// 窗体失去焦点---不激活的事件
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void CallDataDocmentView_Deactivate(object sender, EventArgs e)
        {
            PublicDataClass._WindowsVisable.CallDataUpdatVisable = false;        //窗体不可见
            timer1.Enabled = false;
        
        }
        /// <summary>
        /// 处理设备应答的信息
        /// </summary>
        /// <param name="无"></param>
        /// <param name="无"></param>
        /// <param anthor="cuibj"></param>
        /// <param Time="11-04-28"></param>
        private void ProcessShowAllInfo()
        {
            if (comboBoxData.SelectedIndex == 0)
            {
                ShowYcValueInfo();                      //显示遥测信息
             

            }
            else if (comboBoxData.SelectedIndex == 1)
            {

                ShowYxValueInfo();                      //显示遥信信息

            }
            else if (comboBoxData.SelectedIndex == 3)                    //召测版本号
            {
                ShowDeviceInformation();
            }
            else if (comboBoxData.SelectedIndex == 4)   //时间的
            {
                ShowDeviceTime();

            }
            else if (comboBoxData.SelectedIndex == 7 || comboBoxData.SelectedIndex == 8 || comboBoxData.SelectedIndex == 9 ||
                     comboBoxData.SelectedIndex == 10 || comboBoxData.SelectedIndex == 11 || comboBoxData.SelectedIndex == 12 ||
                     comboBoxData.SelectedIndex == 13 || comboBoxData.SelectedIndex == 14 || comboBoxData.SelectedIndex == 16 ||
                     comboBoxData.SelectedIndex == 17 || comboBoxData.SelectedIndex == 20 || comboBoxData.SelectedIndex == 21 || comboBoxData.SelectedIndex == 22 || comboBoxData.SelectedIndex == 23)
            {

                ShowParamInformation();                  //显示参数信息
            }
            else if (comboBoxData.SelectedIndex == 15)
            {
                ShowYxOfInValueInfo();                      //显示内遥信信息

            }
            else if (comboBoxData.SelectedIndex == 19)
            {
                ShowHardInformation();                      //显示器件状态信息

            }
        }

        /// <summary>
        /// 自定义---函数  显示器件状态信息
        /// </summary>
        private void ShowHardInformation()
        {
            byte pos = 0;
            PageTable.Clear();
            pagenum = 0;
            for (byte j = 0; j <=(PublicDataClass._DataField.FieldLen-2)/11; j++)
            {
                str = @"";
                dr = PageTable.NewRow();


                dr["序号"] = String.Format("{0:d}", j);

                if (j == 0)
                {
                    //lv.SubItems.Add("厂商代号:");
                    dr["名称"] = "器件字符串长度";
                    //for (byte i = 0; i < 1; i++)
                    str += Convert.ToString(PublicDataClass._DataField.Buffer[pos] );     //  + PublicDataClass._DataField.Buffer[pos + 1] << 8     
                    dr["数值"] = str;
                    pos += 2;
                }
                else
                {
                    //for (byte temp = 0; temp < (PublicDataClass._DataField.FieldLen - 2) / 22; temp++)
                    //{
                        //if (j == temp * 2 + 1)
                        //{
                            //dr["名称"] = "参数1字符串";
                            for (byte i = 0; i < 10; i++)
                                str += Convert.ToChar(PublicDataClass._DataField.Buffer[pos + i]);
                            dr["名称"] = str;
                            pos += 10;
                        //}
                        //else if (j == temp * 2 + 2)
                        //{
                            //dr["名称"] = "器件状态";
                            if (PublicDataClass._DataField.Buffer[pos] == 1)
                                str = @"正常";
                            else
                                str = @"故障";

                            dr["数值"] = str;
                            pos += 1;
                        //}

                    //}
                 }

             

              
                dr["单位"] = "无";
                dr["倍率"] = "无";
                PageTable.Rows.Add(dr);
                pagenum++;
             
            }
            if (PageTable.DataSet != null)
            {
                PageTable.DataSet.Tables.Remove(PageTable);
            }
            CaligrationPageNum(pagenum);
            PaginationSet.Tables.Clear();
            PaginationSet.Tables.Add(PageTable);   // 
            Pagefm.SetDataSet(PaginationSet, out PageTable);
            Display(PageTable);




        }
        /// <summary>
        /// 自定义---函数  显示版本信息
        /// </summary>
        private void ShowDeviceInformation()
        {
            PageTable.Clear();
            pagenum = 0;
            for (byte j = 0; j < 5; j++)
            {
                str = @"";
                dr = PageTable.NewRow();


                dr["序号"] = String.Format("{0:d}", j);

                if (j == 0)
                {
                    //lv.SubItems.Add("厂商代号:");
                    dr["名称"] = "厂商代号";
                    for (byte i = 0; i < 4; i++)
                        str += Convert.ToChar(PublicDataClass._DataField.Buffer[i]);
                    //lv.SubItems.Add(str);
                    dr["数值"] = str;
                }
                else if (j == 1)
                {

                    //lv.SubItems.Add("设备编号:");
                    dr["名称"] = "设备编号";
                    for (byte i = 4; i < 13; i++)
                        str += Convert.ToChar(PublicDataClass._DataField.Buffer[i]);
                    dr["数值"] = str;

                }
                else if (j == 2)
                {
                    //lv.SubItems.Add("软件版本号:");
                    dr["名称"] = "软件版本号";
                    for (byte i = 13; i < 19; i++)
                        str += Convert.ToChar(PublicDataClass._DataField.Buffer[i]);
                    dr["数值"] = str;

                }
                else if (j == 3)
                {
                    //lv.SubItems.Add("终端软件发布时间:");
                    dr["名称"] = "终端软件发布时间";
                    str += String.Format("{0:x}", PublicDataClass._DataField.Buffer[21]);
                    str += "年";
                    str += String.Format("{0:x}", PublicDataClass._DataField.Buffer[20]);
                    str += "月";
                    str += String.Format("{0:x}", PublicDataClass._DataField.Buffer[19]);
                    str += "日";
                    dr["数值"] = str;

                }
                else
                {
                    //lv.SubItems.Add("终端配置容量信息码:");
                    dr["名称"] = "终端配置容量信息码";
                    for (byte i = 22; i < 24; i++)
                        str += Convert.ToChar(PublicDataClass._DataField.Buffer[i]);
                    dr["数值"] = str;

                }
                dr["单位"] = "无";
                dr["倍率"] = "无";
                PageTable.Rows.Add(dr);
                pagenum++;
                //lv.SubItems.Add("无");
                // lv.SubItems.Add("无");

                //listView1.Items.Add(lv);
            }
            if (PageTable.DataSet != null)
            {
                PageTable.DataSet.Tables.Remove(PageTable);
            }
            CaligrationPageNum(pagenum);
            PaginationSet.Tables.Clear();
            PaginationSet.Tables.Add(PageTable);   // 
            Pagefm.SetDataSet(PaginationSet, out PageTable);
            Display(PageTable);




        }
        private void ShowDeviceTime()
        {
            pagenum = 0;
            PageTable.Clear();
            str = @"";

            dr = PageTable.NewRow();

            dr["序号"] = String.Format("{0:g}", 0);
            dr["名称"] = "当前时间:";

            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 1]);
            str += "年";
            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 2]);
            str += "月";

            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 3] & 0x1f);  //日+星期
            str += "日";

            str += "[星期" + String.Format("{0:d}", (PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 3] & 0xe0) >> 5) + "]";

            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 4]);
            str += "时";
            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 5]);
            str += "分";
            int ms = (PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 6] << 8) +
                  PublicDataClass._DataField.Buffer[PublicDataClass._DataField.FieldLen - 7];

            str += String.Format("{0:d}", ms);
            str += "毫秒";

            dr["数值"] = str;
            dr["单位"] = "<时间>";
            dr["倍率"] = "无";
            PageTable.Rows.Add(dr);
            pagenum++;
            if (PageTable.DataSet != null)
            {
                PageTable.DataSet.Tables.Remove(PageTable);
            }
            CaligrationPageNum(pagenum);
            PaginationSet.Tables.Clear();
            PaginationSet.Tables.Add(PageTable);   // 
            Pagefm.SetDataSet(PaginationSet, out PageTable);
            Display(PageTable);

        }
        /// <summary>
        /// 显示遥测数值信息
        /// </summary>
        private void ShowYcValueInfo()
        {
             
     
            int startp = 0;//其实点号位置
            int StartPos = 0;
            byte[] bytes = new byte[4];
            float fdata = 0.0F;
            int idate = 0;
            int k = 0;
            string StartName = @"";
            byte dx = PublicFunction.FindPointNameCorrelativeIndex(comboBoxPoint.Text);
            if (PublicDataClass.ChanelId == 2)
            {
                if (datepos == 0)
                { pagenum = 0; PageTable.Clear(); LiShiTable.Clear(); }

                StartPos = PublicDataClass._DataField.Buffer[2];
                StartPos = StartPos << 16;
                StartPos += PublicDataClass._DataField.Buffer[0] + (PublicDataClass._DataField.Buffer[1] << 8);


                StartName = PublicFunction.FindStartPosCorrelativeName(1, StartPos, dx);       //找起始点号
                startp = PublicFunction.FindStartPos(1, StartPos, dx);//找起始点号位置



           
                for (int j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                {
                    str = @"";


                    dr = LiShiTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", datepos);

                    // if (PublicDataClass.SaveText.Cfg[dx].YccfgState[StartPos - 0x4001] == "是")
                    //    if (PublicDataClass.SaveText.Cfg[dx].YccfgState[datepos] == "是")
                    if (PublicDataClass.SaveText.Cfg[dx].YccfgState[startp] == "是")
                    {
                        if (j == 0)
                            dr["名称"] = StartName;//将名称添加入列表中       
                        else
                            //   dr["名称"] =PublicDataClass.SaveText.Cfg[dx].YccfgName[datepos];
                            dr["名称"] = PublicDataClass.SaveText.Cfg[dx].YccfgName[startp];



                        //data = PublicDataClass._DataField.Buffer[k + 5];
                        //data = data << 16;


                        bytes[0] = PublicDataClass._DataField.Buffer[k + 3];
                        bytes[1] = PublicDataClass._DataField.Buffer[k + 4];
                        bytes[2] = PublicDataClass._DataField.Buffer[k + 5];
                        bytes[3] = PublicDataClass._DataField.Buffer[k + 6];

                        fdata = BitConverter.ToSingle(bytes, 0);
                        //data = PublicDataClass._DataField.Buffer[k + 3] + (PublicDataClass._DataField.Buffer[k + 4] << 8);
                        //if (data > 0x8000)
                        //data = data - 65536;
                        k += 5;

                        dr["数值"] = String.Format("{0:f4}", fdata);

                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        LiShiTable.Rows.Add(dr);
                        pagenum++;

                    }
                    datepos++;
                    startp++;
                    if (datepos >= PublicDataClass.SaveText.Cfg[dx].YccfgNum)
                    {

                        break;
                    }
                    if (startp >= PublicDataClass.SaveText.Cfg[dx].YccfgNum)
                    {

                        break;
                    }
                    StartPos++;
                }
                if (First_Frame == true)  //首帧
                {
                    First_Frame = false;
   
                }
                if (datepos == 0) //首帧
                {
                    First_Frame = false;

                }
                PageTable = LiShiTable.Copy();
                PaginationSet.Tables.Clear();
                PaginationSet.Tables.Add(PageTable);   //
                Pagefm.SetDataSet(PaginationSet, out PageTable);
                 


                CaligrationPageNum(pagenum);
                if (datepos >= PublicDataClass.SaveText.Cfg[dx].YccfgNum)
                {
                    First_Frame = true;
                    pagenumLine = pagenum;              //zxl 0416
                    pagenumIndex = pagenum;             //zxl 0416
                    pagenum = 0;
                    datepos = 0;
                    //if (LiShiTable.DataSet != null)
                    //{
                    //    LiShiTable.DataSet.Tables.Remove(LiShiTable);
                    //}
                    SaveTable = LiShiTable.Copy();
                    //PaginationSet.Tables.Clear();
                    //PaginationSet.Tables.Add(LiShiTable);
                    //Pagefm.SetDataSet(PaginationSet, out LiShiTable);
                    //PageTable = LiShiTable.Copy();


                    if (ShowType == 0)   //选择类型  0：按线路   1：按序号
                    {
                        byte po = FindCfgInfo();
                        if (SaveTable.Rows.Count == 0)
                            return;
                        object[] item = new object[SaveTable.Columns.Count];//定义一个object类型的数组
                        PageTable.Clear();
                        CaligrationPageNum(pagenumIndex);
                        pagenumLine = pagenumIndex;

                        PaginationSet.Tables.Clear();

                        for (int i = 0; i < pagenumIndex; i++)//循环遍历数据表中的每一行数据
                        {
                            for (int j = 0; j < pagenumIndex; j++)
                            {
                                //     if (Convert.ToInt16(PublicDataClass._YcInformationParam.IndexTable[j]) == i)
                                if (Convert.ToInt16(PublicDataClass.SaveText.Cfg[po].YccfgIndex[j]) == i)
                                {
                                    for (int m = 0; m < SaveTable.Columns.Count; m++)//循环遍历数据表中每一列数据
                                    {
                                        item[m] = SaveTable.Rows[j][m];

                                    }
                                    PageTable.Rows.Add(item);
                                }
                            }
                        }
                        if (PageTable.DataSet != null)
                        {
                            PageTable.DataSet.Tables.Remove(PageTable);
                        }
                
                        PaginationSet.Tables.Clear();
                        PaginationSet.Tables.Add(PageTable);
                        Pagefm.SetDataSet(PaginationSet, out PageTable);

                        
                    }
                }
                Display(PageTable);
              

                
            

            }
            else if (PublicDataClass.ChanelId == 1)
            {
                if (datepos == 0)
                { pagenum = 0; PageTable.Clear(); LiShiTable.Clear(); }
               
                for (int j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                {
                    str = @"";
                    dr = LiShiTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", datepos);

                    StartPos = PublicDataClass._DataField.Buffer[k] + (PublicDataClass._DataField.Buffer[k + 1] << 8);

                    StartName = PublicFunction.FindStartPosCorrelativeName(1, StartPos, dx);
                    dr["名称"] = StartName;//将名称添加入列表中  
                    if (PublicDataClass.DataTy == 5)//浮点型              
                    {
                        //     idate = PublicDataClass._DataField.Buffer[k + 2] + (PublicDataClass._DataField.Buffer[k + 3] << 8);
                        bytes[0] = PublicDataClass._DataField.Buffer[k + 2];
                        bytes[1] = PublicDataClass._DataField.Buffer[k + 3];
                        bytes[2] = PublicDataClass._DataField.Buffer[k + 4];
                        bytes[3] = PublicDataClass._DataField.Buffer[k + 5];
                        fdata = BitConverter.ToSingle(bytes, 0);

                        if (idate > 0x8000)
                            idate = idate - 65536;

                        dr["数值"] = String.Format("{0:f4}", fdata);

                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        LiShiTable.Rows.Add(dr);
                        pagenum++;

                        k += 6;
                    }
                    if (PublicDataClass.DataTy == 18)//整型
                    {
                        idate = PublicDataClass._DataField.Buffer[k + 2] + (PublicDataClass._DataField.Buffer[k + 3] << 8);
                        if (idate > 0x8000)
                            idate = idate - 65536;
                        dr["数值"] = Convert.ToString(idate);
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        LiShiTable.Rows.Add(dr);
                        pagenum++;
                        k += 4;
                    }
                    datepos++;
                    if (datepos >= PublicDataClass.SaveText.Cfg[dx].YccfgNum)
                        break;
                }
                if (First_Frame == true)  //首帧
                {
                    First_Frame = false;
               
                }
                if (datepos == 0) //首帧
                {
                    First_Frame = false;
                
                }
               if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }

                PaginationSet.Tables.Clear();
                PageTable = LiShiTable.Copy();
                PaginationSet.Tables.Add(PageTable);   //
                Pagefm.SetDataSet(PaginationSet, out PageTable);


                CaligrationPageNum(pagenum);

                if (datepos >= PublicDataClass.SaveText.Cfg[dx].YccfgNum)
                {
                    First_Frame = true;
                    pagenumLine = pagenum;              //zxl 0416
                    pagenumIndex = pagenum;             //zxl 0416
                    pagenum = 0;
                    datepos = 0;
                    if (LiShiTable.DataSet != null)
                    {
                        LiShiTable.DataSet.Tables.Remove(LiShiTable);
                    }
                    SaveTable = LiShiTable.Copy();
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(LiShiTable);
                    Pagefm.SetDataSet(PaginationSet, out LiShiTable);
                    PageTable = LiShiTable.Copy();
                }
                Display(PageTable);

            }
        }
        /// <summary>
        /// 显示遥信数值信息
        /// </summary>
        private void ShowYxValueInfo()
        {
          //  int a = PublicDataClass._DataField.FieldVSQ;
            string StartName = @"";
     
            byte yxdata;
            byte dx = PublicFunction.FindPointNameCorrelativeIndex(comboBoxPoint.Text);
            if (PublicDataClass.ChanelId == 2)
            {

                if (datepos == 0)
                {
                    pagenum = 0; PageTable.Clear(); LiShiTable.Clear();
                }

                datepos = PublicDataClass._DataField.Buffer[2];
                datepos = datepos << 16;
                datepos += PublicDataClass._DataField.Buffer[0] + (PublicDataClass._DataField.Buffer[1] << 8);


                StartName = PublicFunction.FindStartPosCorrelativeName(2, datepos, dx);       //找起始点号
                for (int j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                {
                    str = @"";

                    dr = LiShiTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", datepos);

                    if (PublicDataClass.SaveText.Cfg[dx].YxcfgState[datepos - 1] == "是")
                    {
                        if (j == 0)
                            dr["名称"] = StartName;//将名称添加入列表中        
                        else
                            dr["名称"] = PublicDataClass.SaveText.Cfg[dx].YxcfgName[datepos - 1];

                        if (PublicDataClass.SaveText.Cfg[dx].Yxdataqf[j] == "0")

                            yxdata = PublicDataClass._DataField.Buffer[j + 3];
                        else
                        {
                            if (PublicDataClass._DataField.Buffer[j + 3] == 1)
                                yxdata = 0;
                            else 
                                yxdata = 1;

                        }
                        
                        dr["数值"] = String.Format("{0:d}", yxdata);
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        LiShiTable.Rows.Add(dr);
                        pagenum++;

                    }
                    datepos++;
                    if (datepos > PublicDataClass.SaveText.Cfg[dx].YxcfgNum)
                        break;

                }

                if (First_Frame == true)  //首帧
                {
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    First_Frame = false;

                }
                if (datepos == 0) //首帧
                {
                    First_Frame = false;
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                }
                PaginationSet.Tables.Clear();
                PageTable = LiShiTable.Copy();
                PaginationSet.Tables.Add(PageTable);   //
                Pagefm.SetDataSet(PaginationSet, out PageTable);


                CaligrationPageNum(pagenum);
                if (datepos >= PublicDataClass.SaveText.Cfg[dx].YxcfgNum)
                {
                    First_Frame = true;
                    if (LiShiTable.DataSet != null)
                    {
                        LiShiTable.DataSet.Tables.Remove(LiShiTable);
                    }
                    SaveTable = LiShiTable.Copy();
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(LiShiTable);
                    Pagefm.SetDataSet(PaginationSet, out LiShiTable);
                    PageTable = LiShiTable.Copy();
                }
                Display(PageTable);
            }
            else if (PublicDataClass.ChanelId == 1)  //串口
            {
                int addr = 0;
                byte k = 0;
                if (datepos == 0)
                { pagenum = 0; PageTable.Clear(); LiShiTable.Clear(); }
                for (int j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                {
                    str = @"";
                    dr = LiShiTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", datepos);

                    addr = PublicDataClass._DataField.Buffer[k] + (PublicDataClass._DataField.Buffer[k + 1] << 8);

                    StartName = PublicFunction.FindStartPosCorrelativeName(2, addr, dx);

                    if (PublicDataClass.SaveText.Cfg[dx].YxcfgState[addr - 1] == "是")
                    {
                        dr["名称"] = StartName;//将名称添加入列表中 
                        dr["数值"] = Convert.ToString(PublicDataClass._DataField.Buffer[k + 2]);

                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        LiShiTable.Rows.Add(dr);
                        pagenum++;
                        k += 3;

                    }
                    datepos++;
                    if (datepos >= PublicDataClass.SaveText.Cfg[dx].YxcfgNum)
                        break;
                }
                if (First_Frame == true)  //首帧
                {
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    First_Frame = false;

                }
                if (datepos == 0) //首帧
                {
                    First_Frame = false;
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                }
                PaginationSet.Tables.Clear();
                PageTable = LiShiTable.Copy();
                PaginationSet.Tables.Add(PageTable);   //
                Pagefm.SetDataSet(PaginationSet, out PageTable);


                CaligrationPageNum(pagenum);
                if (datepos >= PublicDataClass.SaveText.Cfg[dx].YxcfgNum)
                {
                    First_Frame = true;
                    if (LiShiTable.DataSet != null)
                    {
                        LiShiTable.DataSet.Tables.Remove(LiShiTable);
                    }
                    SaveTable = LiShiTable.Copy();
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(LiShiTable);
                    Pagefm.SetDataSet(PaginationSet, out LiShiTable);
                    PageTable = LiShiTable.Copy();
                }
                Display(PageTable);
            }

        }
        private void ShowYxOfInValueInfo()
        {

            byte dx = PublicFunction.FindPointNameCorrelativeIndex(comboBoxPoint.Text);
            if (PublicDataClass.ChanelId == 2)
            {
                pagenum = 0;
                PageTable.Clear();
                for (int j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                {
                    str = @"";

                    dr = PageTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", j);
                    dr["名称"] = PublicDataClass.ThreeYNameTable.YxOfinTable[j];
                    dr["数值"] = Convert.ToString(PublicDataClass._DataField.Buffer[j + 3]);

                    dr["单位"] = "无";
                    dr["倍率"] = "无";
                    PageTable.Rows.Add(dr);
                    pagenum++;
                }

                if (PageTable.DataSet != null)
                {
                    PageTable.DataSet.Tables.Remove(PageTable);
                }
                CaligrationPageNum(pagenum);
                SaveTable = LiShiTable.Copy();
                PaginationSet.Tables.Clear();
                PaginationSet.Tables.Add(PageTable);   // 
                Pagefm.SetDataSet(PaginationSet, out PageTable);
                Display(PageTable);
            }
            else if (PublicDataClass.ChanelId == 1)  //串口
            {

                byte k = 0;
                pagenum = 0; PageTable.Clear();
                for (int j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                {
                    str = @"";
                    dr = PageTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", j);


                    dr["数值"] = Convert.ToString(PublicDataClass._DataField.Buffer[k + 2]);
                    dr["单位"] = "无";
                    dr["倍率"] = "无";
                    PageTable.Rows.Add(dr);
                    pagenum++;
                    k += 3;
                }

                if (PageTable.DataSet != null)
                {
                    PageTable.DataSet.Tables.Remove(PageTable);
                }
                PaginationSet.Tables.Clear();
                PaginationSet.Tables.Add(PageTable);   //
                Pagefm.SetDataSet(PaginationSet, out PageTable);
                CaligrationPageNum(pagenum);
                Display(PageTable);
            }
        }

        #region Show Param Infomation
        /// <summary>
        /// 显示参数信息
        /// </summary>
        private void ShowParamInformation()
        {
            try
            {
                byte pos = 0;
                //byte[] bytes = new byte[4];
                //float fdata = 0.0F;

                if ((PublicDataClass.ParamInfoAddr >= 0x7001) && (PublicDataClass.ParamInfoAddr <= 0x7fff))     //遥测参数
                {
                    //pagenum = 0;
                    //   PageTable.Clear();       
                    //  for (byte j = 0; j < PublicDataClass._YcParam.num / 3; j++)
                    if (datepos == 0)
                    { pagenum = 0; PageTable.Clear(); LiShiTable.Clear(); }
                    for (byte j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {
                        str = @"";
                        dr = PageTable.NewRow();


                        //   dr["序号"] = String.Format("{0:d}", j);
                        dr["序号"] = String.Format("{0:d}", datepos);
                        dr["名称"] = PublicDataClass._YcParam.NameTable[j];

                        if (PublicDataClass._YcParam.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YcParam.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }
                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;
                        datepos++;

                        if (datepos >= PublicDataClass._YcParam.num / 3)
                        {

                            break;
                        }
                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);
                }
                if ((PublicDataClass.ParamInfoAddr >= 0x8001) && (PublicDataClass.ParamInfoAddr <= 0x8fff))     //遥信参数
                {
                    pagenum = 0;
                    PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._YxParam.num / 3; j++)
                    {
                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        dr["名称"] = PublicDataClass._YxParam.NameTable[j];

                        if (PublicDataClass._YxParam.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YxParam.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }
                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;
                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);

                }
                if ((PublicDataClass.ParamInfoAddr >= 0x9001) && (PublicDataClass.ParamInfoAddr <= 0x9fff))  //遥控参数
                {
                    pagenum = 0;
                    PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._YkParam.num / 3; j++)
                    {
                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        dr["名称"] = PublicDataClass._YkParam.NameTable[j];

                        if (PublicDataClass._YkParam.ByteTable[j] == "4")
                        {
                            byte[] bytes = new byte[4];
                            bytes[0] = PublicDataClass._DataField.Buffer[pos];
                            bytes[1] = PublicDataClass._DataField.Buffer[pos + 1];
                            bytes[2] = PublicDataClass._DataField.Buffer[pos + 2];
                            bytes[3] = PublicDataClass._DataField.Buffer[pos + 3];

                            float fdata = BitConverter.ToSingle(bytes, 0);

                            str += String.Format("{0:f4}", fdata);

                            pos += 4;
                        }
                        if (PublicDataClass._YkParam.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YkParam.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }
                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);
                }
                else if ((PublicDataClass.ParamInfoAddr >= 0x5001) && (PublicDataClass.ParamInfoAddr <= 0x50ff))    //网络参数
                {
                    byte ch = 0;
                    pagenum = 0;
                    PageTable.Clear();
                    for (byte k = 0; k < PublicDataClass._DataField.FieldVSQ; k++)
                    {

                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", ch);
                        dr["名称"] = String.Format("网口{0:d}的信息", k);
                        dr["数值"] = "";
                        dr["单位"] = "";
                        dr["倍率"] = "";
                        PageTable.Rows.Add(dr);
                        pagenum++;
                        for (byte j = 0; j < 5; j++)
                        {
                            ch++;
                            dr = PageTable.NewRow();
                            dr["序号"] = String.Format("{0:d}", ch);

                            str = @"";

                            if (j == 0)
                            {

                                dr["名称"] = "IP地址:";
                                for (byte i = pos; i < pos + 4; i++)
                                {
                                    str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[i]);
                                    if (i < (pos + 3))
                                        str += ".";
                                }
                                pos += 4;
                                dr["数值"] = str;
                            }
                            else if (j == 1)
                            {

                                dr["名称"] = "掩码:";
                                for (byte i = pos; i < pos + 4; i++)
                                {
                                    str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[i]);
                                    if (i < (pos + 3))
                                        str += ".";
                                }
                                pos += 4;
                                dr["数值"] = str;
                            }
                            else if (j == 2)
                            {

                                dr["名称"] = "网关:";
                                for (byte i = pos; i < pos + 4; i++)
                                {
                                    str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[i]);
                                    if (i < (pos + 3))
                                        str += ".";
                                }
                                pos += 4;
                                dr["数值"] = str;
                                //ptr += 4;
                            }
                            else if (j == 3)
                            {
                                dr["名称"] = "端口号:";
                                str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                                dr["数值"] = str;
                                pos += 2;

                            }
                            else
                            {
                                dr["名称"] = "MAC地址:";
                                for (byte i = pos; i < pos + 6; i++)
                                {
                                    str += String.Format("{0:x2}", PublicDataClass._DataField.Buffer[i]);
                                    if (i < (pos + 5))
                                        str += "-";
                                }
                                pos += 6;
                                dr["数值"] = str;

                            }
                            dr["单位"] = "";
                            dr["倍率"] = "";
                            pagenum++;
                            PageTable.Rows.Add(dr);
                        }

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);
                }
                else if ((PublicDataClass.ParamInfoAddr >= 0x5100) && (PublicDataClass.ParamInfoAddr <= 0x51ff))    //系统参数
                {
                    pagenum = 0;
                    PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._SysParam.num; j++)
                    {
                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        dr["名称"] = PublicDataClass._SysParam.NameTable[j];


                        if (PublicDataClass._SysParam.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._SysParam.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }
                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);
                }
                else if ((PublicDataClass.ParamInfoAddr >= 0xa001) && (PublicDataClass.ParamInfoAddr <= 0xafff))  //遥信配置
                {
                    pagenum = 0;
                    PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {

                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        dr["名称"] = PublicDataClass._YxLineCfgParam.NameTable[j];



                        if (PublicDataClass._YxLineCfgParam.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YxLineCfgParam.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }

                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);

                }

                else if ((PublicDataClass.ParamInfoAddr >= 0x5300) && (PublicDataClass.ParamInfoAddr <= 0x53ff))  //越限配置
                {
                    pagenum = 0; PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._RaoDong.num / 3; j++)
                    {
                        str = @""; dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        dr["名称"] = PublicDataClass._RaoDong.NameTable[j];
                        if (PublicDataClass._RaoDong.ByteTable[j] == "4")
                        {
                            byte[] bytes = new byte[4];
                            bytes[0] = PublicDataClass._DataField.Buffer[pos];
                            bytes[1] = PublicDataClass._DataField.Buffer[pos + 1];
                            bytes[2] = PublicDataClass._DataField.Buffer[pos + 2];
                            bytes[3] = PublicDataClass._DataField.Buffer[pos + 3];

                            float fdata = BitConverter.ToSingle(bytes, 0);

                            str += String.Format("{0:f4}", fdata);

                            pos += 4;
                        }
                        if (PublicDataClass._RaoDong.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._RaoDong.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]); pos += 1;
                        }
                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;
                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);
                }
                else if ((PublicDataClass.ParamInfoAddr >= 0x5400) && (PublicDataClass.ParamInfoAddr <= 0x54ff))  //索引记录
                {
                    pagenum = 0; PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {
                        str = @""; dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        if (j == 0)
                            dr["名称"] = "开关变位记录数目";
                        else if (j == 1)
                            dr["名称"] = "SOE变位记录数目";
                        else if (j == 2)
                            dr["名称"] = "遥控记录数目";
                        else if (j == 3)
                            dr["名称"] = "电池遥控记录数目";
                        else if (j == 4)
                            dr["名称"] = "电池遥信记录数目";
                        else
                            dr["名称"] = "停电记录数目";

                        str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]); pos += 1;
                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;
                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);
                }

                else if ((PublicDataClass.ParamInfoAddr >= 0xa001) && (PublicDataClass.ParamInfoAddr <= 0xafff))  //遥信配置
                {
                    if (datepos == 0)
                    { pagenum = 0; PageTable.Clear(); LiShiTable.Clear(); }
                    //pagenum = 0;
                    //PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {

                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", datepos);
                        dr["名称"] = PublicDataClass._YxLineCfgParam.NameTable[j];



                        if (PublicDataClass._YxLineCfgParam.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YxLineCfgParam.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }

                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;
                        datepos++;

                    }
                    if (First_Frame == true)  //首帧
                    {
                        First_Frame = false;

                    }

                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);

                }

                else if ((PublicDataClass.ParamInfoAddr >= 0xb001) && (PublicDataClass.ParamInfoAddr <= 0xbfff))  //遥测配置
                {
                    if (datepos == 0)
                    { pagenum = 0; PageTable.Clear(); LiShiTable.Clear(); }
                    //pagenum = 0;
                    //PageTable.Clear();


                    for (int j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {
                        str = @"";

                        dr = LiShiTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", datepos);
                        dr["名称"] = PublicDataClass._YcLineCfgParam.NameTable[datepos];

                        if (PublicDataClass._YcLineCfgParam.ByteTable[datepos] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YcLineCfgParam.ByteTable[datepos] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }
                        datepos++;
                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        LiShiTable.Rows.Add(dr);
                        pagenum++;

                    }
                    if (First_Frame == true)  //首帧
                    {
                        First_Frame = false;

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    PageTable = LiShiTable.Copy();
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   //
                    Pagefm.SetDataSet(PaginationSet, out PageTable);


                    CaligrationPageNum(pagenum);

                    if (datepos == (PublicDataClass._YcLineCfgParam.num / 3))
                    {
                        First_Frame = true;
                        datepos = 0;
                        if (LiShiTable.DataSet != null)
                        {
                            LiShiTable.DataSet.Tables.Remove(LiShiTable);
                        }
                        PaginationSet.Tables.Clear();
                        PaginationSet.Tables.Add(LiShiTable);
                        Pagefm.SetDataSet(PaginationSet, out LiShiTable);
                        PageTable = LiShiTable.Copy();
                    }
                    Display(PageTable);

                }
                else if ((PublicDataClass.ParamInfoAddr >= 0x5200) && (PublicDataClass.ParamInfoAddr <= 0x52ff))  //串口参数
                {
                    byte ch = 0;
                    pagenum = 0; PageTable.Clear();
                    for (byte k = 0; k < PublicDataClass._DataField.FieldVSQ; k++)
                    {
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", ch);
                        dr["名称"] = String.Format("串口{0:d}的信息", k);
                        dr["数值"] = "";
                        dr["单位"] = "";
                        dr["倍率"] = "";
                        PageTable.Rows.Add(dr);
                        pagenum++;

                        for (byte j = 0; j < 3; j++)
                        {
                            ch++;
                            dr = PageTable.NewRow();
                            dr["序号"] = String.Format("{0:d}", ch);
                            str = @"";

                            if (j == 0)
                            {

                                dr["名称"] = "波特率:";
                                switch (PublicDataClass._DataField.Buffer[k * 3])
                                {
                                    case 0:
                                        str = "300";
                                        break;
                                    case 1:
                                        str = "600";
                                        break;
                                    case 2:
                                        str = "1200";
                                        break;
                                    case 3:
                                        str = "2400";
                                        break;
                                    case 4:
                                        str = "4800";
                                        break;
                                    case 5:
                                        str = "9600";
                                        break;
                                    case 6:
                                        str = "115200";
                                        break;
                                }
                                dr["数值"] = str;
                            }
                            else if (j == 1)
                            {


                                dr["名称"] = "校验:";
                                switch (PublicDataClass._DataField.Buffer[k * 3 + 1])
                                {
                                    case 0:
                                        str = "奇";
                                        break;
                                    case 1:
                                        str = "偶";
                                        break;
                                    case 2:
                                        str = "无";
                                        break;
                                }
                                dr["数值"] = str;
                            }
                            else if (j == 2)
                            {
                                dr["名称"] = "数据位:";
                                switch (PublicDataClass._DataField.Buffer[k * 3 + 2])
                                {
                                    case 0:
                                        str = "5";
                                        break;
                                    case 1:
                                        str = "6";
                                        break;
                                    case 2:
                                        str = "7";
                                        break;
                                    case 3:
                                        str = "8";
                                        break;
                                }
                                dr["数值"] = str;
                            }

                            dr["单位"] = "无";
                            dr["倍率"] = "无";
                            PageTable.Rows.Add(dr);
                            pagenum++;
                        }

                    }
                    CaligrationPageNum(pagenum);
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);
                }
                else if (PublicDataClass.ParamInfoAddr == 0xF101)   //软压板参数
                {
                    int s;
                    pagenum = 0;
                    PageTable.Clear();
                    for (s = 0; s < PublicDataClass.FILENAME.Length; s++)
                    {
                        if (PublicDataClass.TabCfg[s].PageName == "软压板")
                            break;
                    }
                    for (byte j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {

                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);


                        //dr["名称"] = PublicDataClass._FuncConfigParam.NameTable[j];
                        dr["名称"] = PublicDataClass.TabCfg[s].TabPageValue[1].ValueTable[j];


                        if (PublicDataClass.TabCfg[s].TabPageValue[3].ValueTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass.TabCfg[s].TabPageValue[3].ValueTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }

                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);

                }
                else if ((PublicDataClass.ParamInfoAddr >= 0xf201) && (PublicDataClass.ParamInfoAddr <= 0xf2ff))  //遥控逻辑配置参数
                {
                    pagenum = 0;
                    PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {

                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        dr["名称"] = PublicDataClass._YkLogicInfo.NameTable[j];



                        if (PublicDataClass._YkLogicInfo.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YkLogicInfo.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }

                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);

                }
                else if (PublicDataClass.ParamInfoAddr == 0x5900)  //反时限保护配置参数
                {
                    pagenum = 0;
                    PageTable.Clear();

                    str = @"";
                    dr = PageTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", 0);
                    dr["名称"] = "额定电流值";


                    byte[] bytes = new byte[4];
                    bytes[0] = PublicDataClass._DataField.Buffer[pos];
                    bytes[1] = PublicDataClass._DataField.Buffer[pos + 1];
                    bytes[2] = PublicDataClass._DataField.Buffer[pos + 2];
                    bytes[3] = PublicDataClass._DataField.Buffer[pos + 3];

                    float fdata = BitConverter.ToSingle(bytes, 0);

                    str += String.Format("{0:f4}", fdata);

                    pos += 4;


                    dr["数值"] = str;
                    dr["单位"] = "无";
                    dr["倍率"] = "无";
                    PageTable.Rows.Add(dr);
                    pagenum++;


                    str = @"";
                    dr = PageTable.NewRow();
                    dr["序号"] = String.Format("{0:d}", 1);
                    dr["名称"] = "保护方式";
                    if (PublicDataClass._DataField.Buffer[pos] == 0)
                        str = "不启用";
                    else if (PublicDataClass._DataField.Buffer[pos] == 1)
                        str = "一般";
                    else if (PublicDataClass._DataField.Buffer[pos] == 2)
                        str = "正常";
                    else if (PublicDataClass._DataField.Buffer[pos] == 3)
                        str = "极端";


                    dr["数值"] = str;
                    dr["单位"] = "无";
                    dr["倍率"] = "无";
                    PageTable.Rows.Add(dr);
                    pagenum++;


                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);

                }
                else if ((PublicDataClass.ParamInfoAddr >= 0xf301) && (PublicDataClass.ParamInfoAddr <= 0xffff))  //遥信取反
                {
                    pagenum = 0;
                    PageTable.Clear();
                    for (byte j = 0; j < PublicDataClass._DataField.FieldVSQ; j++)
                    {

                        str = @"";
                        dr = PageTable.NewRow();
                        dr["序号"] = String.Format("{0:d}", j);
                        dr["名称"] = PublicDataClass.ThreeYNameTable.YxTable[j];


                        if (PublicDataClass._YxDataQFParam.ByteTable[j] == "2")
                        {
                            str += String.Format("{0:d}", (PublicDataClass._DataField.Buffer[pos + 1] << 8) + PublicDataClass._DataField.Buffer[pos]);
                            pos += 2;
                        }
                        if (PublicDataClass._YxDataQFParam.ByteTable[j] == "1")
                        {
                            str += String.Format("{0:d}", PublicDataClass._DataField.Buffer[pos]);
                            pos += 1;

                        }

                        dr["数值"] = str;
                        dr["单位"] = "无";
                        dr["倍率"] = "无";
                        PageTable.Rows.Add(dr);
                        pagenum++;

                    }
                    if (PageTable.DataSet != null)
                    {
                        PageTable.DataSet.Tables.Remove(PageTable);
                    }
                    CaligrationPageNum(pagenum);
                    PaginationSet.Tables.Clear();
                    PaginationSet.Tables.Add(PageTable);   // 
                    Pagefm.SetDataSet(PaginationSet, out PageTable);
                    Display(PageTable);

                }
            }
            catch
            { }

        }
        #endregion
        /// <summary>
        /// 清空--按钮的事件响应
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void buttonclear_Click(object sender, EventArgs e)
        {
            //listView1.Items.Clear();
            PageTable.Clear();
            Display(PageTable);

        }
        /// <summary>
        /// 首页按钮--菜单的选择
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void FistPage_Click(object sender, EventArgs e)
        {
            pagenow = 1;
            nowpage.Text = Convert.ToString(pagenow);
            CheckPageState();


            PageTable = null;//清空数据表中原有内容
            Pagefm.GoToFirstPage(out PageTable);//跳转到首页
            Display(PageTable);//显示数据
        }
        /// <summary>
        /// 上一页按钮-的响应函数
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void PreviousPage_Click(object sender, EventArgs e)
        {
            pagenow--;
            nowpage.Text = Convert.ToString(pagenow);

            CheckPageState();

            PageTable = null;//清空数据表中原有内容
            Pagefm.GoToPreviousPage(out PageTable);//跳转到上一页
            Display(PageTable);//显示数据
        }
        /// <summary>
        /// 下一页按钮--的响应函数
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void NextPage_Click(object sender, EventArgs e)
        {
            pagenow++;
            nowpage.Text = Convert.ToString(pagenow);

            CheckPageState();

            PageTable = null;//清空数据表中原有内容
            Pagefm.GoToNextPage(out PageTable);//跳转到下一列
            Display(PageTable);//显示数据
        }
        /// <summary>
        /// 最后一页按钮的--响应函数
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void LastPage_Click(object sender, EventArgs e)
        {
            pagenow = pagetotal;
            nowpage.Text = Convert.ToString(pagenow);
            CheckPageState();

            PageTable = null;//清空数据表中原有内容
            Pagefm.GoToLastPage(out PageTable);//跳转到尾页
            Display(PageTable);//显示数据
        }
        #region Custom Functions

        /// <summary>
        /// 自定义--显示函数
        /// </summary>
        /// <param name="PageTable"></param>
        private void Display(DataTable PageTable)
        {

            if (PageTable != null)//当数据表中存在记录时
            {
                ListData.Rows.Clear();
                object[] item = new object[PageTable.Columns.Count];//定义一个object类型的数组
                for (int i = 0; i < PageTable.Rows.Count; i++)//循环遍历数据表中的每一行数据
                {
                    for (int j = 0; j < PageTable.Columns.Count; j++)//循环遍历数据表中每一列数据
                    {
                        item[j] = PageTable.Rows[i][j];//保存数据表中的数据内容
                    }
                    ListData.Rows.Add(item);//向DataGridView中添加数据


                }
            }
        }

        private void CaligrationPageNum(int num)   //计算页数目
        {
            if (num < Pagefm.ItemsPerPage)
            {

                totalpage.Text = "1";
                nowpage.Text = "1";
                FistPage.Enabled = false;
                PreviousPage.Enabled = false;
                NextPage.Enabled = false;
                LastPage.Enabled = false;
            }
            else
            {
                FistPage.Enabled = false;
                PreviousPage.Enabled = false;
                NextPage.Enabled = true;
                LastPage.Enabled = true;
                nowpage.Text = "1";

                if ((num % Pagefm.ItemsPerPage) == 0)
                    pagetotal = num / Pagefm.ItemsPerPage;
                else
                    pagetotal = num / Pagefm.ItemsPerPage + 1;
                totalpage.Text = Convert.ToString(pagetotal);
            }

        }
        private void CheckPageState()   //判断页的状态
        {
            if (pagenow == pagetotal)   //当前页 ==总页数
            {
                LastPage.Enabled = false; NextPage.Enabled = false; PreviousPage.Enabled = true; FistPage.Enabled = true;
            }
            else if (pagenow == 1)  //当前页 ==首页
            {
                LastPage.Enabled = true; NextPage.Enabled = true; PreviousPage.Enabled = false; FistPage.Enabled = false;
            }
            else
            {

                LastPage.Enabled = true; NextPage.Enabled = true; PreviousPage.Enabled = true; FistPage.Enabled = true;
            }
        }
        #endregion
        /// <summary>
        /// 窗体大小 ---改变的响应函数
        /// </summary>
        static int Rows = 0;
        private void CallDataDocmentView_SizeChanged(object sender, EventArgs e)
        {
            if (First_Start == false)
            {
                return;
            }

            ListData.Columns[1].Width = (splitContainer2.Panel1.Width - ListData.Columns[0].Width - ListData.Columns[3].Width - ListData.Columns[4].Width) / 2;
            ListData.Columns[2].Width = (splitContainer2.Panel1.Width - ListData.Columns[0].Width - ListData.Columns[3].Width - ListData.Columns[4].Width) / 2;
            Pagefm.ItemsPerPage = (splitContainer2.Panel1.Height / ListData.RowTemplate.Height) - 2;

            if (Rows != Pagefm.ItemsPerPage)
            {
                /*if(pagenum ==0)
                   PageTable.Clear();
                for(int i=pagenum;i<Pagefm.ItemsPerPage;i++)
                {
                    dr = PageTable.NewRow();
                    dr["序号"] = "";
                    dr["名称"] = "";
                    dr["数值"] = "";
                    dr["单位"] = "";
                    dr["倍率"] = "";
                    PageTable.Rows.Add(dr);
                }


                Display(PageTable);*/
                Rows = Pagefm.ItemsPerPage;
            }

        }

        private void buttonseach_Click(object sender, EventArgs e)
        {
            if (seachpage.Text == "")
            {
                MessageBox.Show("内容为空", "提示", MessageBoxButtons.OK, MessageBoxIcon.Error);
                return;
            }
            int pageseach = Convert.ToInt16(seachpage.Text);
            if (pageseach <= 0 || pageseach > pagetotal)
            {
                MessageBox.Show("查询的页号非法", "提示", MessageBoxButtons.OK, MessageBoxIcon.Error);
                return;
            }
            if (pageseach == pagenow)  //首页
            {
                pagenow = 1;
                nowpage.Text = Convert.ToString(pagenow);
                CheckPageState();

                PageTable = null;//清空数据表中原有内容
                Pagefm.GoToFirstPage(out PageTable);//跳转到首页
                Display(PageTable);//显示数据
            }
            else if (pageseach == pagetotal)  //未页
            {
                pagenow = pagetotal;
                nowpage.Text = Convert.ToString(pagenow);
                CheckPageState();

                PageTable = null;//清空数据表中原有内容
                Pagefm.GoToLastPage(out PageTable);//跳转到尾页
                Display(PageTable);//显示数据
            }
            else
            {
                pagenow = pageseach;
                nowpage.Text = Convert.ToString(pagenow);
                CheckPageState();
                PageTable = null;//清空数据表中原有内容
                Pagefm.GoToSeachPage(pageseach, out PageTable);//跳转到尾页
                Display(PageTable);//显示数据
            }
        }
        /// <summary>
        /// 导出-按钮的消息响应
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void output_Click(object sender, EventArgs e)
        {
            if (ListData.RowCount > 0)
            {
                SaveFileDialog savefile = new SaveFileDialog();
                savefile.Filter = "*.xls|*.*";
                saveret = savefile.ShowDialog() == DialogResult.OK;
                savename = savefile.FileName;
                output.Text = "导出中..";
                savefile.Dispose();
            }
            else
            {
                MessageBox.Show("无可用的数据导出", "提示", MessageBoxButtons.OK, MessageBoxIcon.Error);
                return;
            }
        }
        #region ExportToExcel
        /// <summary>
        ///  导出--excel
        /// </summary>

        private void ExportToExcel(string path)
        {

            //Microsoft.Office.Interop.Excel.ApplicationClass excel = new Microsoft.Office.Interop.Excel.ApplicationClass();
            //excel.Application.Workbooks.Add(true);
            OperateExcel Ex = new OperateExcel();   //新建一个excel文件
            Ex.CreateNewExcel();
            if (comboBoxData.SelectedIndex == 0 || comboBoxData.SelectedIndex == 1)
            {
                PageTable = SaveTable.Copy();
                SaveTable.Clear();
            }

            for (int i = 0; i < PageTable.Columns.Count; i++)
            {
                Ex.SetCellValue(Ex.ws, 1, i + 1, PageTable.Columns[i].ColumnName);
            }

            for (int i = 0; i < PageTable.Rows.Count; i++)
            {
                for (int j = 0; j < ListData.Columns.Count; j++)
                {

                    Ex.SetCellValue(Ex.ws, i + 2, j + 1, PageTable.Rows[i][j]);
                }
            }
            Ex.SaveAsExcel(savename);
            Ex.CloseExcel();
            /*for (int i = 0; i < ListData.ColumnCount; i++)
            {
                app.Cells[1, i + 1] = ListData.Columns[i].HeaderText;
            }
            //填充数据
            for (int i = 0; i < ListData.RowCount - 1; i++)
            {
                for (int j = 0; j < ListData.ColumnCount; j++)
                {
                    if (ListData[j, i].Value == typeof(string))
                    {
                        app.Cells[i + 2, j + 1] = "" + ListData[i, j].Value.ToString();
                    }
                    else
                    {
                        app.Cells[i + 2, j + 1] = ListData[j, i].Value.ToString();
                    }
                }
            }
            wb.SaveAs(path, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlExclusive, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);
            app.Quit();
            app = null;*/



        }
        #endregion

        private void seachpage_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (e.KeyChar != '\b')//这是允许输入退格键
            {
                if ((e.KeyChar < '0') || (e.KeyChar > '9'))//这是允许输入0-9数字
                {

                    MessageBox.Show("只能输入数字！", "提示", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    e.Handled = true;
                }
            }
        }

        private void checkBox1_CheckedChanged(object sender, EventArgs e)
        {
            if (checkBox1.Checked == true)
            {
                //  domainUpDownb.Enabled = true;
                delaytime = Convert.ToInt16(domainUpDownb.Text);
                timer2.Enabled = true;

            }
            else
            {
                //   domainUpDownb.Enabled = false;
                timer2.Enabled = false;
            }
        }

        private void timer2_Tick(object sender, EventArgs e)
        {
            if (PublicDataClass._WindowsVisable.CallDataUpdatVisable == true)  //窗体可见
            {
                delaytime--;
                if (delaytime == 0)
                {

                    if (PublicDataClass.LinSPointName == "无信息")
                    {
                        MessageBox.Show("无测量点信息可操作", "信息", MessageBoxButtons.OK, MessageBoxIcon.Error);
                        return;
                    }
                    else
                    {
                        ty = PublicFunction.CheckPointOfCommunicationEntrace(comboBoxPoint.Text);
                        if (ty == 0)
                        {
                            MessageBox.Show("无测量点信息可操作", "信息", MessageBoxButtons.OK, MessageBoxIcon.Error);
                            return;

                        }

                    }
                    if (comboBoxData.SelectedIndex == 0)    //F0_遥测
                    {
                        datepos = 0;
                   
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.AloneCallYc_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.AloneCallYc_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.AloneCallYc_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.AloneCallYc_1 = true;

                    }

                    else if (comboBoxData.SelectedIndex == 1)  //F1__遥信
                    {
                        datepos = 0;
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.AloneCallYx_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.AloneCallYx_1 = true;

                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.AloneCallYx_1 = true;

                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.AloneCallYx_1 = true;
                    }
                    else if (comboBoxData.SelectedIndex == 2)  //F3__遥脉
                    {
                        //listView1.Items.Clear();
                    }
                    else if (comboBoxData.SelectedIndex == 3)          //版本号
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.VERSION_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.VERSION_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.VERSION_1 = true;

                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.VERSION_1 = true;

                    }
                    else if (comboBoxData.SelectedIndex == 4)        //时间
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.CALLTIME_1 = true;

                        else if (ty == 2)
                            PublicDataClass._NetTaskFlag.CALLTIME_1 = true;
                        else if (ty == 3)
                            PublicDataClass._GprsTaskFlag.CALLTIME_1 = true;
                        else if (ty == 4)
                            PublicDataClass._UsbTaskFlag.CALLTIME_1 = true;

                    }
                    else if (comboBoxData.SelectedIndex == 5)          //F6__1类数据
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.VERSION_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.VERSION_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.VERSION_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.VERSION_1 = true;

                    }
                    else if (comboBoxData.SelectedIndex == 6)        //F7__2类数据
                    {
                        //listView1.Items.Clear();

                    }
                    else if (comboBoxData.SelectedIndex == 7)        //F8__网络参数
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x5001;

                    }
                    else if (comboBoxData.SelectedIndex == 8)        //F9__系统参数
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x5100;

                    }
                    else if (comboBoxData.SelectedIndex == 9)        //F10__遥测参数
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x7001;

                    }
                    else if (comboBoxData.SelectedIndex == 10)        //F11__遥信参数
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x8001;

                    }
                    else if (comboBoxData.SelectedIndex == 11)        //F12__遥控参数
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x9001;

                    }
                    else if (comboBoxData.SelectedIndex == 12)        //F13__遥信配置参数
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0xa001;

                    }
                    else if (comboBoxData.SelectedIndex == 13)        //F14__遥测配置参数
                    {
                        datepos = 0;
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0xb001;
                    }
                    else if (comboBoxData.SelectedIndex == 14)      //F15__串口参数
                    {
                        datepos = 0;
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x5200;

                    }
                    else if (comboBoxData.SelectedIndex == 15)        //内遥信
                    {
                        //listView1.Items.Clear();
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.AloneCallYx_2 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.AloneCallYx_2 = true;

                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.AloneCallYx_2 = true;

                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.AloneCallYx_2 = true;
                    }
                    else if (comboBoxData.SelectedIndex == 16)        //越限参数
                    {
                        datepos = 0;
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x5300;

                    }
                    else if (comboBoxData.SelectedIndex == 17)        //索引记录
                    {
                        datepos = 0;
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        PublicDataClass.ParamInfoAddr = 0x5400;

                    }
                    else if (comboBoxData.SelectedIndex == 20)        //软压板参数
                    {
                        datepos = 0;
                        if (ty == 1)
                            PublicDataClass._ComTaskFlag.READ_P_1 = true;

                        if (ty == 2)
                            PublicDataClass._NetTaskFlag.READ_P_1 = true;
                        if (ty == 3)
                            PublicDataClass._GprsTaskFlag.READ_P_1 = true;
                        if (ty == 4)
                            PublicDataClass._UsbTaskFlag.READ_P_1 = true;
                        //PublicDataClass.ParamInfoAddr = 0x5400;

                    }

                    delaytime = Convert.ToInt16(domainUpDownb.Text);

                }


            }

        }

        private void label5_Click(object sender, EventArgs e)
        {

        }

        private void domainUpDownb_SelectedItemChanged(object sender, EventArgs e)
        {

        }

        private void splitContainer1_Panel1_Paint(object sender, PaintEventArgs e)
        {

        }



        private void comboBoxselete_SelectedIndexChanged(object sender, EventArgs e)
        {
          

            if (comboBoxselete.SelectedIndex == 1)
            {

                ShowType = 1;   //选择类型  0：按线路   1：按序号
                if (SaveTable.Rows.Count == 0)
                    return;
            
                PageTable.Clear();
                CaligrationPageNum(pagenumIndex);
                pagenumLine = pagenumIndex;
                PageTable = LiShiTable.Copy();
                if (PageTable.DataSet != null)
                {
                    PageTable.DataSet.Tables.Remove(PageTable);
                }
            
                PaginationSet.Tables.Clear();
                PaginationSet.Tables.Add(PageTable);
                Pagefm.SetDataSet(PaginationSet, out PageTable);
           
               
                Display(PageTable);


            }
  
            else if (comboBoxselete.SelectedIndex == 0)
            {
                ShowType = 0;   //选择类型  0：按线路   1：按序号
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                byte po = FindCfgInfo();
                if (SaveTable.Rows.Count == 0)
                    return;
                object[] item = new object[SaveTable.Columns.Count];//定义一个object类型的数组
                PageTable.Clear();
                CaligrationPageNum(pagenumIndex);
                pagenumLine = pagenumIndex;

               

                for (int i = 0; i < pagenumIndex; i++)//循环遍历数据表中的每一行数据
                {
                    for (int j = 0; j < pagenumIndex; j++)
                    {
                        //     if (Convert.ToInt16(PublicDataClass._YcInformationParam.IndexTable[j]) == i)
                        if (Convert.ToInt16(PublicDataClass.SaveText.Cfg[po].YccfgIndex[j]) == i)
                        {
                            for (int m = 0; m < SaveTable.Columns.Count; m++)//循环遍历数据表中每一列数据
                            {
                                item[m] = SaveTable.Rows[j][m];

                            }
                            PageTable.Rows.Add(item);
                        }
                    }
                }


                if (PageTable.DataSet != null)
                {
                    PageTable.DataSet.Tables.Remove(PageTable);
                }
             
                PaginationSet.Tables.Clear();
                PaginationSet.Tables.Add(PageTable);
                Pagefm.SetDataSet(PaginationSet, out PageTable);

                Display(PageTable);
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

             /*   int i;
                int j = 0;
                if (SaveTable.Rows.Count == 0)
                    return;
                object[] item = new object[SaveTable.Columns.Count];//定义一个object类型的数组
                for (i = 0; i < 12; i++)//循环遍历数据表中的每一行数据
                {
                    if (i < 8)
                    {

                        for (j = 0; j < SaveTable.Columns.Count; j++)//循环遍历数据表中每一列数据
                        {
                            item[j] = SaveTable.Rows[i][j];

                        }
                        YcDataTable.Rows.Add(item);//向DataGridView中添加数据  
                    }
                    else
                    {

                        if (i == 8)
                            j = 113;
                        else if (i == 9)
                            j = 114;
                        else if (i == 10)
                            j = 115;
                        else if (i == 11)
                            j = 116;

                        for (int k = 0; k < SaveTable.Columns.Count; k++)
                            item[k] = SaveTable.Rows[j][k];
                        YcDataTable.Rows.Add(item);//向DataGridView中添加数据

                    }
                }
                //电流
                for (int k = 0; k < 15; k++)
                {
                    for (i = (8 + k); i <= (98 + k); i += 15)
                    {
                        for (j = 0; j < SaveTable.Columns.Count; j++)//循环遍历数据表中每一列数据
                        {
                            item[j] = SaveTable.Rows[i][j];

                        }
                        YcDataTable.Rows.Add(item);//向DataGridView中添加数据
                    }
                    for (i = (117 + k); i <= (387 + k); i += 15)
                    {
                        for (j = 0; j < SaveTable.Columns.Count; j++)//循环遍历数据表中每一列数据
                        {
                            item[j] = SaveTable.Rows[i][j];

                        }
                        YcDataTable.Rows.Add(item);//向DataGridView中添加数据
                    }
                }
                for (j = 0; j < SaveTable.Columns.Count; j++)//循环遍历数据表中每一列数据
                {
                    item[j] = SaveTable.Rows[SaveTable.Rows.Count - 2][j];

                }
                YcDataTable.Rows.Add(item);//向DataGridView中添加数据
                for (j = 0; j < SaveTable.Columns.Count; j++)//循环遍历数据表中每一列数据
                {
                    item[j] = SaveTable.Rows[SaveTable.Rows.Count - 1][j];

                }
                YcDataTable.Rows.Add(item);//向DataGridView中添加数据

             //   PageTable = null;//清空数据表中原有内容
                PageTable.Clear();
                CaligrationPageNum(pagenumLine);
                pagenumIndex = pagenumLine;
                pagenumLine = 0;

                PaginationSet.Tables.Clear();
                PageTable = YcDataTable.Copy();
                PaginationSet.Tables.Add(PageTable);   // 
                Pagefm.SetDataSet(PaginationSet, out PageTable);

                Display(PageTable);*/
            }
        }

        private void comboBoxData_SelectedIndexChanged(object sender, EventArgs e)
        {
                 if (comboBoxData.SelectedIndex == 0)    //F0_遥测
                     comboBoxselete.Enabled = true;
                 else comboBoxselete.Enabled = false;

        }

        private void label6_Click(object sender, EventArgs e)
        {

        }
    }
}
